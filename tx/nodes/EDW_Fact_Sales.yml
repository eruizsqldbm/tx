name: Fact_Sales
id: d4f3899a-e004-4893-832b-0d9d34f82f90
storageLocationId: 4085255e-7806-47c9-b989-eee6ab87f2a1
templateId: 868ce611-8c34-40b7-8e89-5a3190b1e2c8
materialization: table
isSource: false
columns:
  - name: SUPPLIER_KEY
    dataType: NUMBER(38,0)
    allowNulls: false
    defaultValue: ''
    description: A unique identifier for each supplier within the system.
    id: 5e5afb13-f2c2-44d5-8d49-a4c8a8cd18f1
  - name: STORE_KEY
    dataType: NUMBER(38,0)
    allowNulls: false
    defaultValue: ''
    description: A unique identifier for each store in the retail chain.
    id: 407e8aaa-87a4-4a48-9aaa-e809cf6bd695
  - name: PROMOTION_KEY
    dataType: NUMBER(38,0)
    allowNulls: false
    defaultValue: ''
    description: A unique identifier for each promotional campaign or offer.
    id: f31b41b6-deb3-4c7d-96e8-f02896a758a4
  - name: PRODUCT_KEY
    dataType: NUMBER(38,0)
    allowNulls: false
    defaultValue: ''
    description: A unique identifier for each product available for sale.
    id: d58995f8-ea02-4674-8802-cc573dda621a
  - name: EMPLOYEE_KEY
    dataType: NUMBER(38,0)
    allowNulls: false
    defaultValue: ''
    description: A unique identifier for each employee within the organization.
    id: dbfcf593-3ca1-48ed-96f5-2e0ad8dce7de
  - name: DATE_KEY
    dataType: NUMBER(38,0)
    allowNulls: false
    defaultValue: ''
    description: A unique identifier for each date in the calendar used for transactions.
    id: e1e81ca2-1084-480b-9560-53ff0547d45e
  - name: CUSTOMER_KEY
    dataType: NUMBER(38,0)
    allowNulls: false
    defaultValue: ''
    description: A unique identifier for each customer in the database.
    id: 25cf4787-720b-4d79-bf0a-525501ba52dd
  - name: CHANNEL_KEY
    dataType: NUMBER(38,0)
    allowNulls: false
    defaultValue: ''
    description: >-
      A unique identifier for each sales channel through which products are
      sold.
    id: 561308e5-a157-4c9e-ab60-1d5ddd2b1faa
  - name: SUPPLIER_ID
    dataType: VARCHAR(50)
    allowNulls: false
    defaultValue: ''
    description: >-
      The identification number assigned to the supplier, used for tracking
      purposes.
    id: 083d78fb-67c3-46c8-a4d4-3d5fdc0b140a
  - name: SUPPLIER_NAME
    dataType: VARCHAR(100)
    allowNulls: false
    defaultValue: ''
    description: The name of the supplier or vendor providing products.
    id: 127c8b18-c12c-4cff-a6e2-9ea431d1d647
  - name: CONTACT_INFO
    dataType: VARCHAR(100)
    allowNulls: true
    defaultValue: ''
    description: >-
      The contact details for the supplier, including phone numbers and email
      addresses.
    id: 4d67c047-602e-48f2-9d67-7a61815989b8
  - name: STORE_ID
    dataType: VARCHAR(50)
    allowNulls: false
    defaultValue: ''
    description: The identification number for the specific retail location.
    id: c8ff51f7-767e-4f50-aab2-617e7dcc59d2
  - name: STORE_NAME
    dataType: VARCHAR(100)
    allowNulls: false
    defaultValue: ''
    description: The name of the store, typically reflecting the brand or location
    id: 2f14d4bd-2136-4379-8ebe-0d4eee22818c
  - name: CITY
    dataType: VARCHAR(50)
    allowNulls: true
    defaultValue: ''
    description: The city where the store is located.
    id: 6260a011-8e8c-4b4c-b264-169a0deddf28
  - name: STATE
    dataType: VARCHAR(50)
    allowNulls: true
    defaultValue: ''
    description: The state in which the store operates.
    id: 6362096a-e8db-4830-82ec-0c39d6707be9
  - name: COUNTRY
    dataType: VARCHAR(50)
    allowNulls: true
    defaultValue: ''
    description: he country where the store is situated.
    id: 88c00b99-0e12-4012-b8a4-05a65b91c8f8
  - name: REGION_KEY
    dataType: NUMBER(38,0)
    allowNulls: true
    defaultValue: ''
    description: A unique identifier for the geographic region that the store belongs to.
    id: 394b2d2c-89eb-4b8f-8490-12213e1aa485
  - name: PROMOTION_ID
    dataType: VARCHAR(50)
    allowNulls: false
    defaultValue: ''
    description: The identification number for a specific promotional event.
    id: 8f7650ee-29e0-4885-9b94-45e392ea4a18
  - name: PROMOTION_DESCRIPTION
    dataType: VARCHAR(255)
    allowNulls: true
    defaultValue: ''
    description: A brief description of the promotional offer.
    id: 1737045f-1b8e-45eb-9a3b-764ec01c472d
  - name: START_DATE
    dataType: DATE
    allowNulls: true
    defaultValue: ''
    description: The date when the promotion begins.
    id: 0b080920-88c6-43ab-8040-067175583f10
  - name: END_DATE
    dataType: DATE
    allowNulls: true
    defaultValue: ''
    description: The date when the promotion concludes.
    id: 50df3a53-2c23-4723-91bc-b30ba0b7d85b
  - name: PRODUCT_ID
    dataType: VARCHAR(50)
    allowNulls: false
    defaultValue: ''
    description: The identification number for the product.
    id: b1969636-6f77-4113-8c03-01101ce91340
  - name: PRODUCT_NAME
    dataType: VARCHAR(100)
    allowNulls: false
    defaultValue: ''
    description: The name of the product as it appears to customers.
    id: b0c48775-8f6c-4a91-8cee-f33712ef80a4
  - name: CATEGORY_KEY
    dataType: NUMBER(38,0)
    allowNulls: true
    defaultValue: ''
    description: A unique identifier for the category to which the product belongs.
    id: c30225a2-6707-4299-a147-0e283076e510
  - name: PRICE
    dataType: NUMBER(10,2)
    allowNulls: true
    defaultValue: ''
    description: The retail price of the product.
    id: e71dc3df-437a-4b27-add1-6bbb939b4bad
  - name: EMPLOYEE_ID
    dataType: VARCHAR(50)
    allowNulls: false
    defaultValue: ''
    description: The unique identification number assigned to each employee.
    id: 3413dbc1-6a56-4cb0-9210-d3c9386973ec
  - name: EMPLOYEE_NAME
    dataType: VARCHAR(100)
    allowNulls: false
    defaultValue: ''
    description: The full name of the employee.
    id: 15665a81-62b2-483b-be07-4bd7a8df6cfb
  - name: JOB_TITLE
    dataType: VARCHAR(50)
    allowNulls: true
    defaultValue: ''
    description: The official job title of the employee within the organization.
    id: c29cff5c-9627-471f-8096-d1a3db6b7520
  - name: DATE
    dataType: DATE
    allowNulls: false
    defaultValue: ''
    description: The calendar date represented in a standard format.
    id: 1e29be92-3aea-4eb2-a8bf-ba4370626ba5
  - name: DAY
    dataType: NUMBER(38,0)
    allowNulls: false
    defaultValue: ''
    description: The day of the month, ranging from 1 to 31.
    id: ab6ebd63-db40-4543-becc-819e7f5d994a
  - name: MONTH
    dataType: NUMBER(38,0)
    allowNulls: false
    defaultValue: ''
    description: The month of the year, represented as a number or name.
    id: 19022adc-ff60-455e-b6b2-a1e95bc8c2ec
  - name: YEAR
    dataType: NUMBER(38,0)
    allowNulls: false
    defaultValue: ''
    description: The year of the date.
    id: 6a4b4579-4cd2-45d1-bd47-92df07e2525f
  - name: QUARTER
    dataType: NUMBER(38,0)
    allowNulls: false
    defaultValue: ''
    description: The financial quarter of the year to which the date belongs.
    id: 7bc10602-bc6b-4acc-a70e-d8878230d812
  - name: CUSTOMER_ID
    dataType: VARCHAR(50)
    allowNulls: false
    defaultValue: ''
    description: The unique identification number for each customer.
    id: 410bde6a-343b-4b89-b5d5-f7bdbc70f9d0
  - name: CUSTOMER_NAME
    dataType: VARCHAR(100)
    allowNulls: false
    defaultValue: ''
    description: The name of the customer as recorded in the system.
    id: f49a3392-ba94-444f-ae0e-fcc44691018f
  - name: EMAIL
    dataType: VARCHAR(100)
    allowNulls: true
    defaultValue: ''
    description: The email address associated with the customer.
    id: 786fa6cb-43d7-4556-baf4-030bf27ef5d8
  - name: PHONE
    dataType: VARCHAR(20)
    allowNulls: true
    defaultValue: ''
    description: The phone number provided by the customer for contact purposes.
    id: fc913927-bbb9-4826-bb48-4d7dfa4ec2dd
  - name: CHANNEL_ID
    dataType: VARCHAR(50)
    allowNulls: false
    defaultValue: ''
    description: The identification number for each sales channel.
    id: 2c708759-840d-4411-bb18-7049b17aa6c3
  - name: CHANNEL_NAME
    dataType: VARCHAR(100)
    allowNulls: false
    defaultValue: ''
    description: The name of the sales channel (e.g., online, in-store).
    id: 366604ea-e8e2-47cd-b5dd-9c7635bdbadb
  - name: QUANTITY_SOLD
    dataType: NUMBER(10,0)
    allowNulls: false
    defaultValue: ''
    description: The total number of units sold in a transaction.
    id: 41341f19-260d-4b7f-8c9c-63df57097f71
  - name: SALES_AMOUNT
    dataType: NUMBER(10,2)
    allowNulls: false
    defaultValue: ''
    description: The total revenue generated from the sales transaction.
    id: 744cc7bc-ec2b-420c-b594-cf214b3d0d31
  - name: DISCOUNT_AMOUNT
    dataType: NUMBER(10,2)
    allowNulls: true
    defaultValue: '0'
    description: The total value of discounts applied to the transaction.
    id: 2583a0a3-3641-4f5a-a144-4bc065251303
  - name: TOTAL_COST
    dataType: NUMBER(10,2)
    allowNulls: false
    defaultValue: ''
    description: >-
      The total cost incurred for the transaction, including any expenses
      related to discounts.
    id: 5a9aff2c-eff4-4ccd-ab55-ff0f127e7da8
  - name: load_date
    dataType: DATE
    allowNulls: false
    defaultValue: current_date()
    description: load date
    id: 5659674c-e186-4b44-9612-491b2d93db7c
columnSets:
  - id: 7cfd3cef-b0a7-4e09-9d10-3630918e2a99
    itemName: PK
    setName: >-
      PK_tmp_DIM_SUPPLIER_DIM_STORE_DIM_PROMOTION_DIM_PRODUCT_DIM_EMPLOYEE_DIM_DATE_DIM_CUSTOMER_DIM_CHANNEL_DIM_TRANSACTION
    columns:
      - columnId: 5e5afb13-f2c2-44d5-8d49-a4c8a8cd18f1
        position: 1
        name: SUPPLIER_KEY
      - columnId: 407e8aaa-87a4-4a48-9aaa-e809cf6bd695
        position: 2
        name: STORE_KEY
      - columnId: f31b41b6-deb3-4c7d-96e8-f02896a758a4
        position: 3
        name: PROMOTION_KEY
      - columnId: d58995f8-ea02-4674-8802-cc573dda621a
        position: 4
        name: PRODUCT_KEY
      - columnId: dbfcf593-3ca1-48ed-96f5-2e0ad8dce7de
        position: 5
        name: EMPLOYEE_KEY
      - columnId: e1e81ca2-1084-480b-9560-53ff0547d45e
        position: 6
        name: DATE_KEY
      - columnId: 25cf4787-720b-4d79-bf0a-525501ba52dd
        position: 7
        name: CUSTOMER_KEY
      - columnId: 561308e5-a157-4c9e-ab60-1d5ddd2b1faa
        position: 8
        name: CHANNEL_KEY
nodeFormat: dynamic
truncateBefore: false
preCreate:
  value: ''
  isValidated: false
postCreate:
  value: ''
  isValidated: false
preRun:
  value: ''
  isValidated: false
postRun:
  value: ''
  isValidated: false
my_button: true
my_dropdown: option 1
rely_button: true
parentName: EDW
color: '#1C70FF'
logic: |-
  with "DIM_SUPPLIER" as (
      SELECT
          "SUPPLIER_KEY",
          "SUPPLIER_ID",
          "SUPPLIER_NAME",
          "CONTACT_INFO",
          "load_date"
      FROM {{ref('EDW', 'DIM_SUPPLIER')}}
  ),
  "DIM_STORE" as (
      SELECT
          "STORE_KEY",
          "STORE_ID",
          "STORE_NAME",
          "CITY",
          "STATE",
          "COUNTRY",
          "REGION_KEY",
          "load_date"
      FROM {{ref('EDW', 'DIM_STORE')}}
  ),
  "DIM_PROMOTION" as (
      SELECT
          "PROMOTION_KEY",
          "PROMOTION_ID",
          "PROMOTION_DESCRIPTION",
          "START_DATE",
          "END_DATE",
          "load_date"
      FROM {{ref('EDW', 'DIM_PROMOTION')}}
  ),
  "DIM_PRODUCT" as (
      SELECT
          "PRODUCT_KEY",
          "PRODUCT_ID",
          "PRODUCT_NAME",
          "CATEGORY_KEY",
          "SUPPLIER_KEY",
          "PRICE",
          "load_date"
      FROM {{ref('EDW', 'DIM_PRODUCT')}}
  ),
  "DIM_EMPLOYEE" as (
      SELECT
          "EMPLOYEE_KEY",
          "EMPLOYEE_ID",
          "EMPLOYEE_NAME",
          "JOB_TITLE",
          "load_date"
      FROM {{ref('EDW', 'DIM_EMPLOYEE')}}
  ),
  "DIM_DATE" as (
      SELECT
          "DATE_KEY",
          "DATE",
          "DAY",
          "MONTH",
          "YEAR",
          "QUARTER",
          "load_date"
      FROM {{ref('EDW', 'DIM_DATE')}}
  ),
  "DIM_CUSTOMER" as (
      SELECT
          "CUSTOMER_KEY",
          "CUSTOMER_ID",
          "CUSTOMER_NAME",
          "EMAIL",
          "PHONE",
          "load_date"
      FROM {{ref('EDW', 'DIM_CUSTOMER')}}
  ),
  "DIM_CHANNEL" as (
      SELECT
          "CHANNEL_KEY",
          "CHANNEL_ID",
          "CHANNEL_NAME",
          "load_date"
      FROM {{ref('EDW', 'DIM_CHANNEL')}}
  ),
  "DIM_TRANSACTION" as (
      SELECT
          "TRANSACTION_KEY",
          "DATE_KEY",
          "PRODUCT_KEY",
          "CUSTOMER_KEY",
          "STORE_KEY",
          "CHANNEL_KEY",
          "EMPLOYEE_KEY",
          "PROMOTION_KEY",
          "QUANTITY_SOLD",
          "SALES_AMOUNT",
          "DISCOUNT_AMOUNT",
          "TOTAL_COST",
          "load_date",
      FROM {{ref('EDW', 'DIM_TRANSACTION')}}
  )
  ,
  common as (
      SELECT
          "DIM_SUPPLIER"."SUPPLIER_KEY",
          "DIM_STORE"."STORE_KEY",
          "DIM_PROMOTION"."PROMOTION_KEY",
          "DIM_PRODUCT"."PRODUCT_KEY",
          "DIM_EMPLOYEE"."EMPLOYEE_KEY",
          "DIM_DATE"."DATE_KEY",
          "DIM_CUSTOMER"."CUSTOMER_KEY",
          "DIM_CHANNEL"."CHANNEL_KEY",
          "DIM_SUPPLIER"."SUPPLIER_ID",
          "DIM_SUPPLIER"."SUPPLIER_NAME",
          "DIM_SUPPLIER"."CONTACT_INFO",
          "DIM_STORE"."STORE_ID",
          "DIM_STORE"."STORE_NAME",
          "DIM_STORE"."CITY",
          "DIM_STORE"."STATE",
          "DIM_STORE"."COUNTRY",
          "DIM_STORE"."REGION_KEY",
          "DIM_PROMOTION"."PROMOTION_ID",
          "DIM_PROMOTION"."PROMOTION_DESCRIPTION",
          "DIM_PROMOTION"."START_DATE",
          "DIM_PROMOTION"."END_DATE",
          "DIM_PRODUCT"."PRODUCT_ID",
          "DIM_PRODUCT"."PRODUCT_NAME",
          "DIM_PRODUCT"."CATEGORY_KEY",
          "DIM_PRODUCT"."PRICE",
          "DIM_EMPLOYEE"."EMPLOYEE_ID",
          "DIM_EMPLOYEE"."EMPLOYEE_NAME",
          "DIM_EMPLOYEE"."JOB_TITLE",
          "DIM_DATE"."DATE",
          "DIM_DATE"."DAY",
          "DIM_DATE"."MONTH",
          "DIM_DATE"."YEAR",
          "DIM_DATE"."QUARTER",
          "DIM_CUSTOMER"."CUSTOMER_ID",
          "DIM_CUSTOMER"."CUSTOMER_NAME",
          "DIM_CUSTOMER"."EMAIL",
          "DIM_CUSTOMER"."PHONE",
          "DIM_CHANNEL"."CHANNEL_ID",
          "DIM_CHANNEL"."CHANNEL_NAME",
          "DIM_TRANSACTION"."QUANTITY_SOLD",
          "DIM_TRANSACTION"."SALES_AMOUNT",
          "DIM_TRANSACTION"."DISCOUNT_AMOUNT",
          "DIM_TRANSACTION"."TOTAL_COST",
          current_date() AS "load_date"
          FROM "DIM_PRODUCT"
          JOIN "DIM_SUPPLIER" ON "DIM_SUPPLIER"."SUPPLIER_KEY" = "DIM_PRODUCT"."SUPPLIER_KEY"
          JOIN "DIM_STORE" ON "DIM_STORE"."REGION_KEY" = "DIM_PRODUCT"."CATEGORY_KEY"  -- Example join condition, adjust as needed
          JOIN "DIM_CUSTOMER" ON "DIM_CUSTOMER"."CUSTOMER_KEY" = "DIM_SUPPLIER"."SUPPLIER_KEY"  -- Example join condition, adjust as needed
          JOIN "DIM_EMPLOYEE" ON "DIM_EMPLOYEE"."EMPLOYEE_KEY" = "DIM_SUPPLIER"."SUPPLIER_KEY"  -- Example join condition, adjust as needed
          JOIN "DIM_DATE" ON "DIM_DATE"."DATE_KEY" = "DIM_SUPPLIER"."SUPPLIER_KEY"  -- Example join condition, adjust as needed
          JOIN "DIM_CHANNEL" ON "DIM_CHANNEL"."CHANNEL_KEY" = "DIM_SUPPLIER"."SUPPLIER_KEY"  -- Example join condition, adjust as needed
          JOIN "DIM_TRANSACTION" ON "DIM_TRANSACTION"."CUSTOMER_KEY" = "DIM_CUSTOMER"."CUSTOMER_KEY"
          LEFT JOIN "DIM_PROMOTION" ON "DIM_PROMOTION"."PROMOTION_KEY" = "DIM_PRODUCT"."CATEGORY_KEY"
  )

  SELECT *
  FROM common
description: ''
logicalName: >-
  stage SUPPLIER dimension_stage STORE dimension_stage PROMOTION dimension_stage
  PRODUCT dimension_stage EMPLOYEE dimension_stage DATE dimension_stage CUSTOMER
  dimension_stage CHANNEL dimension_stage TRANSACTION dimension dimension
references:
  52b0f786-8054-4510-9990-45300190dc16:
    parentTableId: 4c687734-f49b-46cc-902b-1ca8e2c08119
    id: 52b0f786-8054-4510-9990-45300190dc16
  fb8c0204-772a-47ff-b56f-acc88fecd512:
    parentTableId: 16e1b412-433c-42e5-a672-5567cc2deb18
    id: fb8c0204-772a-47ff-b56f-acc88fecd512
  ba3b2e12-352d-493c-a05b-5eb80dcc0afd:
    parentTableId: 91da9beb-981d-4a70-9588-b85b07eee73a
    id: ba3b2e12-352d-493c-a05b-5eb80dcc0afd
  5be60b14-d3d8-4f8f-afee-dc9d539c2b51:
    parentTableId: c5196c75-0ed4-4852-986a-7f2422fc35ae
    id: 5be60b14-d3d8-4f8f-afee-dc9d539c2b51
  e136bd35-48cf-4e09-a2c4-d8bebc8c47ed:
    parentTableId: e892c888-77d4-44c5-8fd3-3ff22a71737e
    id: e136bd35-48cf-4e09-a2c4-d8bebc8c47ed
  6c3cf7bc-a850-45d0-8c49-6ff1e1e1c95b:
    parentTableId: 8634bd95-7fb0-46ed-965f-dc8b6d919b21
    id: 6c3cf7bc-a850-45d0-8c49-6ff1e1e1c95b
  4205b1cb-9056-4542-b584-121b42360c0a:
    parentTableId: a252e317-0123-4a90-a35f-de83e5adaa99
    id: 4205b1cb-9056-4542-b584-121b42360c0a
  1fb8bf11-7558-4e4b-9520-77a45d78f02c:
    parentTableId: 3665583d-bc50-49bb-adfe-accac63eb861
    id: 1fb8bf11-7558-4e4b-9520-77a45d78f02c
  fe4e14ff-444c-464a-b09a-52b1122d572a:
    parentTableId: a42ae2f9-085c-470c-a815-2c1e7c31c2b6
    id: fe4e14ff-444c-464a-b09a-52b1122d572a
