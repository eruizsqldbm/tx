name: DIM_stg_CUSTOMER_1
color: '#E53E3E'
isSource: false
columns:
  - name: pk_load_date
    allowNulls: false
    dataType: date
    defaultValue: current_date()
    description: load date
    id: b3744f1b-9f45-47b0-b0ae-dfc3114efbf3
  - name: C_CUSTKEY
    allowNulls: true
    dataType: number(38,0)
    defaultValue: ''
    description: ''
    id: 660b6a81-168a-4961-b06b-3ee15b94bb75
  - name: C_NAME
    allowNulls: true
    dataType: varchar(25)
    defaultValue: ''
    description: ''
    id: 87f54282-13fb-4f88-9297-b0ba85c824b9
  - name: C_ADDRESS
    allowNulls: true
    dataType: varchar(40)
    defaultValue: ''
    description: ''
    id: 96384d6e-2442-485b-9cea-ed41ed93b39d
  - name: C_NATIONKEY
    allowNulls: true
    dataType: number(38,0)
    defaultValue: ''
    description: ''
    id: 2c05538b-427e-4784-88da-603979d74a6f
  - name: C_PHONE
    allowNulls: true
    dataType: varchar(15)
    defaultValue: ''
    description: ''
    id: 954ab26c-6e8f-4243-af51-c82abdf0230d
  - name: C_ACCTBAL
    allowNulls: true
    dataType: number(12,2)
    defaultValue: ''
    description: ''
    id: 30ce5aab-ff8c-426e-83a8-303a2bbd11ae
  - name: C_MKTSEGMENT
    allowNulls: true
    dataType: varchar(10)
    defaultValue: ''
    description: ''
    id: 6184fdca-5ca3-4023-8063-1e939e77a0f7
  - name: C_COMMENT
    allowNulls: true
    dataType: varchar(117)
    defaultValue: ''
    description: ''
    id: 9deed53e-da41-4a63-b96a-77b060eafe5f
  - name: __load_date
    allowNulls: false
    dataType: date
    defaultValue: current_date()
    description: load date
    id: 2a40bbd1-555c-4d95-ac06-99e6b44970b7
  - name: load_date
    allowNulls: false
    dataType: date
    defaultValue: current_date()
    description: load date
    id: 6f7704b0-4f5b-4287-8336-4d9684837c9b
logic: |-
  with "stg_CUSTOMER_1" as (
      SELECT
          "C_CUSTKEY",
          "C_NAME",
          "C_ADDRESS",
          "C_NATIONKEY",
          "C_PHONE",
          "C_ACCTBAL",
          "C_MKTSEGMENT",
          "C_COMMENT",
          "__load_date"
      FROM {{ref('RAW', 'stg_CUSTOMER_1')}}
  )
  , 
  common as (
      SELECT
          current_date() AS "pk_load_date",
          "stg_CUSTOMER_1"."C_CUSTKEY",
          "stg_CUSTOMER_1"."C_NAME",
          "stg_CUSTOMER_1"."C_ADDRESS",
          "stg_CUSTOMER_1"."C_NATIONKEY",
          "stg_CUSTOMER_1"."C_PHONE",
          "stg_CUSTOMER_1"."C_ACCTBAL",
          "stg_CUSTOMER_1"."C_MKTSEGMENT",
          "stg_CUSTOMER_1"."C_COMMENT",
          "stg_CUSTOMER_1"."__load_date",
          current_date() AS "load_date"
      FROM "stg_CUSTOMER_1"
  )

  SELECT * FROM common
description: ''
logicalName: CUSTOMER dimension dimension
columnSets:
  - itemName: PK
    setName: PK_DIM_stg_CUSTOMER_1
    columns:
      - columnId: b3744f1b-9f45-47b0-b0ae-dfc3114efbf3
        position: 1
        name: pk_load_date
    id: ffcf1056-04b2-4791-8d23-9d3687236498
templateId: 093e39c9-f65e-4de0-ab04-7868bf89609d
materialization: table
storageLocationId: 687bf7ac-bcec-4aac-9820-0021ec8cdc2d
preCreate:
  value: ''
  isValidated: false
postCreate:
  value: ''
  isValidated: false
preRun:
  value: ''
  isValidated: false
postRun:
  value: ''
  isValidated: false
my_button: true
my_dropdown: option 1
rely_button: true
id: 3c3ee084-2868-4d51-9259-ba2836599e5f
nodeFormat: dynamic
parentName: EDW
references:
  39b3d442-1fa8-4af5-a2c6-350d3218aa1f:
    parentTableId: 2511b0c3-2ba6-4182-8692-f1d878be1249
    id: 39b3d442-1fa8-4af5-a2c6-350d3218aa1f
